
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>service.job package &#8212; Cilantro alpha documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="service-job-package">
<h1>service.job package<a class="headerlink" href="#service-job-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-service.job.job">
<span id="service-job-job-module"></span><h2>service.job.job module<a class="headerlink" href="#module-service.job.job" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="service.job.job.Job">
<em class="property">class </em><code class="descclassname">service.job.job.</code><code class="descname">Job</code><span class="sig-paren">(</span><em>chain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job.html#Job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job.Job" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wraps a celery task chain and handles ID generation.</p>
<dl class="method">
<dt id="service.job.job.Job.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job.html#Job.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job.Job.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger asynchronous execution of the job chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Return AsyncResult:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">Celery result</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-service.job.job_config">
<span id="service-job-job-config-module"></span><h2>service.job.job_config module<a class="headerlink" href="#module-service.job.job_config" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="service.job.job_config.ConfigParseException">
<em class="property">exception </em><code class="descclassname">service.job.job_config.</code><code class="descname">ConfigParseException</code><a class="reference internal" href="_modules/service/job/job_config.html#ConfigParseException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.ConfigParseException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="service.job.job_config.JobConfig">
<em class="property">class </em><code class="descclassname">service.job.job_config.</code><code class="descname">JobConfig</code><span class="sig-paren">(</span><em>_config_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_config.html#JobConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.JobConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Handle job config parsing and job chain creation.</p>
<p>Chains are created based on the YAML job_type definition found in the
config directory.</p>
<p>Parameters for tasks can be set in three different places:
1. Default values are generated based on the data type configured in the       params section of the job config YAML.
2. Task specific parameters can be set in the tasks section of the job       config.
3. Additional parameters that override the values derived from the job       config can be set when creating a job chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>_config_dir</strong> (<em>str</em>) – path to the configuration directory.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="service.job.job_config.JobConfig.generate_job">
<code class="descname">generate_job</code><span class="sig-paren">(</span><em>job_type</em>, <em>user</em>, <em>request_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_config.html#JobConfig.generate_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.JobConfig.generate_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a celery job chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>job_type</strong> (<em>str</em>) – The name of the config file that defines the job</li>
<li><strong>user</strong> (<em>str</em>) – The user who started the job</li>
<li><strong>request_params</strong> (<em>dict</em>) – Parameters passed in the request</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return Job:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="service.job.job_config.RequestParameterException">
<em class="property">exception </em><code class="descclassname">service.job.job_config.</code><code class="descname">RequestParameterException</code><a class="reference internal" href="_modules/service/job/job_config.html#RequestParameterException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.RequestParameterException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="service.job.job_config.UnknownJobTypeException">
<em class="property">exception </em><code class="descclassname">service.job.job_config.</code><code class="descname">UnknownJobTypeException</code><a class="reference internal" href="_modules/service/job/job_config.html#UnknownJobTypeException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.UnknownJobTypeException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="function">
<dt id="service.job.job_config.generate_chain">
<code class="descclassname">service.job.job_config.</code><code class="descname">generate_chain</code><span class="sig-paren">(</span><em>tasks_def</em>, <em>params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_config.html#generate_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_config.generate_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a celery task chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tasks_def</strong> (<em>list</em>) – A list of (expanded) task definition objects</li>
<li><strong>params</strong> (<em>dict</em>) – Additional params that are made available to all tasks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return Chain:</th><td class="field-body"><p class="first last">Celery task chain</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-service.job.job_controller">
<span id="service-job-job-controller-module"></span><h2>service.job.job_controller module<a class="headerlink" href="#module-service.job.job_controller" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="service.job.job_controller.get_job_config">
<code class="descclassname">service.job.job_controller.</code><code class="descname">get_job_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_controller.html#get_job_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_controller.get_job_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the job config singleton or creates it if it does not exist already.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Return JobConfig:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="service.job.job_controller.job_create">
<code class="descclassname">service.job.job_controller.</code><code class="descname">job_create</code><span class="sig-paren">(</span><em>job_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_controller.html#job_create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_controller.job_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a job of the specified job type.</p>
<p>A task chain is constructed as defined in the corresponding job type
definition YAML file and executed.</p>
<p>Parameters can be provided as JSON objects as part of the request body
and must match the parameters defined in the corresponding job config YAML.</p>
<p>Valid user credential have to be given via HTTP basic authentication.</p>
<p>Also adds the job to the job database.</p>
<p><strong>Example request</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/job/&lt;job-type&gt;</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>

  {
      &quot;metadata&quot;: {
          &quot;volume&quot;: &quot;&quot;,
          &quot;year&quot;: 2018,
          &quot;number&quot;: &quot;&quot;,
          &quot;description&quot;: &quot;[PDFs teilweise verfugbar]&quot;,
          &quot;importFilePath&quot;: &quot;test.pdf&quot;,
          &quot;identification&quot;: &quot;year&quot;
      },
      &quot;files&quot;: [{
          &quot;file&quot;: &quot;test.pdf&quot;,
          &quot;range&quot;: [
              1,
              5
          ]
      }],
      &quot;parts&quot;: [{
              &quot;metadata&quot;: {
                  &quot;title&quot;: &quot;Ein kleines Musterdokument&quot;,
                  &quot;abstract&quot;: &quot;Bachelorarbeit&quot;,
                  &quot;author&quot;: [{
                      &quot;firstname&quot;: &quot;Erich &quot;,
                      &quot;lastname&quot;: &quot;Mustermann&quot;
                  }],
                  &quot;pages&quot;: {
                      &quot;showndesc&quot;: &quot;101320&quot;,
                      &quot;startPrint&quot;: 1,
                      &quot;endPrint&quot;: 2
                  },
                  &quot;date_published&quot;: &quot;2018--&quot;,
                  &quot;language&quot;: &quot;de_DE&quot;,
                  &quot;zenonId&quot;: &quot;&quot;,
                  &quot;auto_publish&quot;: true,
                  &quot;create_frontpage&quot;: false
              },
              &quot;files&quot;: [{
                  &quot;file&quot;: &quot;test.pdf&quot;,
                  &quot;range&quot;: [
                      1,
                      2
                  ]
              }]
          },
          {
              &quot;metadata&quot;: {
                  &quot;title&quot;: &quot;Titel 2&quot;,
                  &quot;author&quot;: [{
                      &quot;firstname&quot;: &quot;Autor&quot;,
                      &quot;lastname&quot;: &quot;Dererste&quot;
                  }],
                  &quot;pages&quot;: {
                      &quot;showndesc&quot;: &quot;2101327&quot;,
                      &quot;startPrint&quot;: 21,
                      &quot;endPrint&quot;: 23
                  },
                  &quot;date_published&quot;: &quot;2018--&quot;,
                  &quot;language&quot;: &quot;de_DE&quot;,
                  &quot;zenonId&quot;: &quot;&quot;,
                  &quot;auto_publish&quot;: true,
                  &quot;create_frontpage&quot;: false
              },
              &quot;files&quot;: [{
                  &quot;file&quot;: &quot;test.pdf&quot;,
                  &quot;range&quot;: [
                      21,
                      23
                  ]
              }]
          }
      ],
      &quot;nlp_params&quot;: {
          &quot;lang&quot;: &quot;de&quot;
      },
      &quot;ojs_metadata&quot;: {
          &quot;ojs_journal_code&quot;: &quot;test&quot;,
          &quot;ojs_user&quot;: &quot;ojs_user&quot;,
          &quot;auto_publish_issue&quot;: false,
          &quot;default_publish_articles&quot;: true,
          &quot;default_create_frontpage&quot;: true,
          &quot;allow_upload_without_file&quot;: false
      },
      &quot;do_ocr&quot;: false
  }
</pre></div>
</div>
<p><strong>Example response SUCCESS</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

{
    &quot;success&quot;: true,
    &quot;job_id&quot;: &quot;010819cc-dc4d-11e8-b152-0242ac130008&quot;,
    &quot;status&quot;: &quot;Accepted&quot;,
    &quot;task_ids&quot;: [
        &quot;9331a617-d35f-4b1a-be24-ec7a970c480e&quot;,
        &quot;f012ef11-1ac0-4810-986a-c31335b918fb&quot;,
        &quot;628abc60-2767-484a-a5c3-0b5a9c1a1ef6&quot;,
        &quot;c2a97fd1-28d2-4e97-b41f-67b6f70d91df&quot;,
        &quot;85cd98a7-fe3f-4e42-91f8-504c074be263&quot;,
        &quot;5af3a39c-f837-41df-8a5e-ecdc55a2bef6&quot;,
        &quot;2576d860-b694-4d41-8190-092f45837c37&quot;,
        &quot;8b7e956a-2fc1-446f-9cc8-9f1d63471b2a&quot;,
        &quot;d2d337a7-f346-4b7e-b1f8-4ee4942716f5&quot;,
        &quot;94304191-45fd-45f0-937c-02a6b13fb64c&quot;,
        &quot;b283d505-4174-4a46-909a-1f742dad6047&quot;,
        &quot;010819cc-dc4d-11e8-b152-0242ac130008&quot;
    ]
}
</pre></div>
</div>
<p><strong>Example response ERROR</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">BAD REQUEST</span>

    {
        &quot;error&quot;: {
            &quot;code&quot;: &quot;bad_request&quot;,
            &quot;message&quot;: &quot;400 Bad Request: The browser (or proxy)
                        sent a request that this server could
                        not understand.&quot;
        },
        &quot;success&quot;: false
    }
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Reqheader Accept:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_type</strong> (<em>str</em>) – name of the job type</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">&lt;json dict metadata:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">descriptive data of the issue/book</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">&lt;json dict files:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">files containing the raw data</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">&lt;json dict parts:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">metadata for sub-parts</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">&lt;json dict nlp_params:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">NLP instructions</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">&lt;json dict ojs_metadata:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">OJS specific metadata</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">&lt;json string do_ocr:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">switch for OCR execution</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Resheader Content-Type:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name">&gt;json dict:</th><td class="field-body">operation result</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status 200:</th><td class="field-body">OK</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A JSON object containing the status, the job id and the task ids
of every subtask in the chain</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="service.job.job_controller.job_list">
<code class="descclassname">service.job.job_controller.</code><code class="descname">job_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_controller.html#job_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_controller.job_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List jobs of the user.</p>
<p>List jobs of the user updated less than a week ago and all jobs, which were
not successful.
If show_all_jobs is set True it returns all jobs.</p>
<p><strong>Example request</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p><strong>Example response SUCCESS</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

[
    {
        &quot;created&quot;: &quot;Tue, 30 Oct 2018 14:06:32 GMT&quot;,
        &quot;errors&quot;: [],
        &quot;job_id&quot;: &quot;010819cc-dc4d-11e8-b152-0242ac130008&quot;,
        &quot;job_type&quot;: &quot;ingest_journal&quot;,
        &quot;name&quot;: &quot;JOB-ingest_journal-test.pdf&quot;
        &quot;state&quot;: &quot;success&quot;,
        &quot;task_ids&quot;: [
            &quot;9331a617-d35f-4b1a-be24-ec7a970c480e&quot;,
            &quot;f012ef11-1ac0-4810-986a-c31335b918fb&quot;,
            &quot;628abc60-2767-484a-a5c3-0b5a9c1a1ef6&quot;,
            &quot;c2a97fd1-28d2-4e97-b41f-67b6f70d91df&quot;,
            &quot;85cd98a7-fe3f-4e42-91f8-504c074be263&quot;,
            &quot;5af3a39c-f837-41df-8a5e-ecdc55a2bef6&quot;,
            &quot;2576d860-b694-4d41-8190-092f45837c37&quot;,
            &quot;8b7e956a-2fc1-446f-9cc8-9f1d63471b2a&quot;,
            &quot;d2d337a7-f346-4b7e-b1f8-4ee4942716f5&quot;,
            &quot;94304191-45fd-45f0-937c-02a6b13fb64c&quot;,
            &quot;b283d505-4174-4a46-909a-1f742dad6047&quot;,
            &quot;010819cc-dc4d-11e8-b152-0242ac130008&quot;
        ],
        &quot;updated&quot;: &quot;Tue, 30 Oct 2018 14:06:59 GMT&quot;,
        &quot;user&quot;: &quot;test_user&quot;
    },
    {
        &quot;created&quot;: &quot;Tue, 30 Oct 2018 14:07:04 GMT&quot;,
        &quot;errors&quot;: [],
        &quot;job_id&quot;: &quot;147b74cc-dc4d-11e8-8db4-0242ac130008&quot;,
        &quot;job_type&quot;: &quot;ingest_journal&quot;,
        &quot;name&quot;: &quot;JOB-ingest_journal-test.pdf&quot;
        &quot;state&quot;: &quot;success&quot;,
        &quot;task_ids&quot;: [
            &quot;55614d2e-e442-46f8-8708-029c8e83c37f&quot;,
            &quot;92ef0e6e-f54c-4bd0-8079-08353d8ed3ea&quot;,
            &quot;e80224ec-e80f-456d-a02d-0d330f106454&quot;,
            &quot;feaa2a85-edc7-4d55-9a07-1940946445bb&quot;,
            &quot;c1c554d5-a37b-4342-80b3-a5cdecab652c&quot;,
            &quot;71c634ed-fe73-4e2e-8f60-ce92109c3dcd&quot;,
            &quot;bb073bbe-1489-495f-9bb2-80343a6f2160&quot;,
            &quot;fd393611-c344-4ed2-b090-ee8b95a337ec&quot;,
            &quot;7b8eceec-aab5-4edf-8a2b-d38981a07911&quot;,
            &quot;6a4f5fe6-6e25-4151-b114-548473f85f82&quot;,
            &quot;484f9623-2ae0-4969-b513-4f99dab1486e&quot;,
            &quot;147b74cc-dc4d-11e8-8db4-0242ac130008&quot;
        ],
        &quot;updated&quot;: &quot;Tue, 30 Oct 2018 14:07:17 GMT&quot;,
        &quot;user&quot;: &quot;test_user&quot;
    }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Query show_all_jobs:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">(optional) if ‘True’, all jobs are listed</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A JSON object containing the list of job objects</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="service.job.job_controller.job_status">
<code class="descclassname">service.job.job_controller.</code><code class="descname">job_status</code><span class="sig-paren">(</span><em>job_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_controller.html#job_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_controller.job_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the status information for a job.</p>
<p>Also looks up the job  in the job database to get the name.</p>
<p>This function is also used to get task status. Those cannot be found in the
job database (as it only holds job info) and no further info will be
returned.</p>
<p><strong>Example request</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/job/&lt;job-id&gt;</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p><strong>Example response</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

{
    &quot;result&quot;: {
        &quot;object_id&quot;: &quot;issue-test-1&quot;
    },
    &quot;status&quot;: &quot;SUCCESS&quot;,
    &quot;type&quot;: &quot;ingest_book&quot;
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Reqheader Accept:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_id</strong> (<em>str</em>) – Job ID</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Resheader Content-Type:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name">&gt;json dict:</th><td class="field-body">operation result</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status 200:</th><td class="field-body">OK</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A JSON object containing the status info</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-service.job.job_type_controller">
<span id="service-job-job-type-controller-module"></span><h2>service.job.job_type_controller module<a class="headerlink" href="#module-service.job.job_type_controller" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="service.job.job_type_controller.get_job_type_detail">
<code class="descclassname">service.job.job_type_controller.</code><code class="descname">get_job_type_detail</code><span class="sig-paren">(</span><em>job_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_type_controller.html#get_job_type_detail"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_type_controller.get_job_type_detail" title="Permalink to this definition">¶</a></dt>
<dd><p>Serve the contents of the YAML file for the job type definition.</p>
<p><strong>Example request</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/job_types/&lt;job_type&gt;</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p><strong>Example response</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

{
    &quot;about&quot;: {
        &quot;description&quot;: &quot;Create a new Issue of an existing journal
                        and upload it&#39;s files to
                        iDAI.publications/journals&quot;,
        &quot;tags&quot;: [
            &quot;OJS&quot;,
            &quot;iDAI.publications/journals&quot;,
            &quot;publish&quot;,
            &quot;journal&quot;,
            &quot;pdf&quot;
        ],
        &quot;title&quot;: &quot;Ingest a Journal-Issue to iDAI.publications/journals&quot;
    },
    &quot;schema&quot;: {
        &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
        &quot;title&quot;: &quot;Ingest Journal schema&quot;,
        &quot;description&quot;: &quot;Use to validate ingest-journal job parameters&quot;,
        &quot;type&quot;: &quot;object&quot;
        &quot;additionalProperties&quot;: false,
        &quot;properties&quot;: {
            &quot;metadata&quot;: {
                &quot;additionalProperties&quot;: false,
                &quot;properties&quot;: {
                    &quot;description&quot;: {
                        &quot;type&quot;: &quot;string&quot;
                    },
                    &quot;identification&quot;: {
                        &quot;type&quot;: &quot;string&quot;
                    }
                },
                &quot;required&quot;: [
                    &quot;description&quot;,
                    &quot;identification&quot;
                ],
                &quot;type&quot;: &quot;object&quot;
            }
        },
        &quot;required&quot;: [
            &quot;metadata&quot;
        ]
    },
    &quot;tasks&quot;: [
        &quot;create_object&quot;,
        {
            &quot;foreach&quot;: [
                {
                    &quot;do&quot;: [
                        {
                            &quot;foreach&quot;: {
                                &quot;target&quot;: &quot;tif&quot;,
                                &quot;task&quot;: &quot;convert.pdf_to_tif&quot;
                            },
                            &quot;list_files&quot;: &quot;origin&quot;,
                            &quot;pattern&quot;: &quot;.pdf$&quot;
                        },
                        {
                            &quot;foreach&quot;: {
                                &quot;target&quot;: &quot;txt&quot;,
                                &quot;task&quot;: &quot;convert.tif_to_txt&quot;
                            },
                            &quot;list_files&quot;: &quot;tif&quot;
                        },
                        {
                            &quot;foreach&quot;: {
                                &quot;target&quot;: &quot;jpg&quot;,
                                &quot;task&quot;: &quot;convert.tif_to_jpg&quot;
                            },
                            &quot;list_files&quot;: &quot;tif&quot;
                        }
                    ],
                    &quot;else&quot;: [
                        {
                            &quot;foreach&quot;: {
                                &quot;target&quot;: &quot;txt&quot;,
                                &quot;task&quot;: &quot;convert.pdf_to_txt&quot;
                            },
                            &quot;list_files&quot;: &quot;origin&quot;,
                            &quot;pattern&quot;: &quot;.pdf$&quot;
                        }
                    ],
                    &quot;if&quot;: &quot;do_ocr&quot;
                },
                {
                    &quot;source&quot;: &quot;txt&quot;,
                    &quot;task&quot;: &quot;nlp.annotate&quot;
                }
            ],
            &quot;list_parts&quot;: null
        },
        {
            &quot;foreach&quot;: {
                &quot;foreach&quot;: {
                    &quot;max_height&quot;: 50,
                    &quot;max_width&quot;: 50,
                    &quot;target_dir&quot;: &quot;thumbnails&quot;,
                    &quot;task&quot;: &quot;convert.scale_image&quot;
                },
                &quot;list_files&quot;: &quot;jpg&quot;
            },
            &quot;list_parts&quot;: null
        },
        {
            &quot;foreach&quot;: {
                &quot;foreach&quot;: {
                    &quot;max_height&quot;: 50,
                    &quot;max_width&quot;: 50,
                    &quot;task&quot;: &quot;convert.scale_image&quot;
                },
                &quot;list_files&quot;: &quot;tif&quot;
            },
            &quot;list_parts&quot;: null
        },
        {
            &quot;dtd_file&quot;: &quot;ojs_import.dtd&quot;,
            &quot;params&quot;: &quot;ojs_metadata&quot;,
            &quot;target_filename&quot;: &quot;ojs_import.xml&quot;,
            &quot;task&quot;: &quot;generate_xml&quot;,
            &quot;template_file&quot;: &quot;ojs_template.xml&quot;
        },
        {
            &quot;foreach&quot;: {
                &quot;schema_file&quot;: &quot;MARC21slim.xsd&quot;,
                &quot;target_filename&quot;: &quot;marc.xml&quot;,
                &quot;task&quot;: &quot;generate_xml&quot;,
                &quot;template_file&quot;: &quot;marc_template.xml&quot;
            },
            &quot;list_parts&quot;: null
        },
        {
            &quot;foreach&quot;: {
                &quot;schema_file&quot;: &quot;mets.xsd&quot;,
                &quot;target_filename&quot;: &quot;mets.xml&quot;,
                &quot;task&quot;: &quot;generate_xml&quot;,
                &quot;template_file&quot;: &quot;mets_template.xml&quot;
            },
            &quot;list_parts&quot;: null
        },
        {
            &quot;params&quot;: &quot;ojs_metadata&quot;,
            &quot;task&quot;: &quot;publish_to_ojs&quot;
        },
        {
            &quot;foreach&quot;: {
                &quot;task&quot;: &quot;generate_frontmatter&quot;
            },
            &quot;list_parts&quot;: null
        },
        &quot;publish_to_repository&quot;,
        &quot;cleanup_workdir&quot;,
        &quot;finish_job&quot;
    ]
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Reqheader Accept:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_type</strong> (<em>str</em>) – Name of the job type</td>
</tr>
<tr class="field-odd field"><th class="field-name">Query schema:</th><td class="field-body">(optional) if set to ‘true’, parameter schema is served</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Resheader Content-Type:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-odd field"><th class="field-name">&gt;json dict:</th><td class="field-body">operation result</td>
</tr>
<tr class="field-even field"><th class="field-name">Status 200:</th><td class="field-body">OK</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">YAML file content of the job type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="service.job.job_type_controller.get_job_types">
<code class="descclassname">service.job.job_type_controller.</code><code class="descname">get_job_types</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/service/job/job_type_controller.html#get_job_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#service.job.job_type_controller.get_job_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a JSON list of available job types and their meta information.</p>
<p><strong>Example request</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/job_types/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p><strong>Example response</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

[
    {
        &quot;about&quot;: {
            &quot;description&quot;: &quot;Create a new Issue of an existing
                            journal, and upload it&#39;s files to
                            iDAI.publications/journals&quot;,
            &quot;tags&quot;: [
                &quot;OJS&quot;,
                &quot;iDAI.publications/journals&quot;,
                &quot;publish&quot;,
                &quot;journal&quot;,
                &quot;pdf&quot;
            ],
            &quot;title&quot;: &quot;Ingest a Journal-Issue to
                      iDAI.publications/journals&quot;
        },
        &quot;name&quot;: &quot;ingest_journal&quot;
    },
    {
        &quot;about&quot;: {
            &quot;description&quot;: &quot;Create a new Book afrom single image
                            files nd upload it to iDAI.repository&quot;,
            &quot;tags&quot;: [
                &quot;repository&quot;,
                &quot;book&quot;,
                &quot;monography&quot;,
                &quot;image&quot;,
                &quot;tiff&quot;
            ],
            &quot;title&quot;: &quot;Ingest a complete book to iDAI.repository&quot;
        },
        &quot;name&quot;: &quot;ingest_book&quot;
    }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Reqheader Accept:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Resheader Content-Type:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">application/json</td>
</tr>
<tr class="field-odd field"><th class="field-name">&gt;json dict:</th><td class="field-body">operation result</td>
</tr>
<tr class="field-even field"><th class="field-name">Status 200:</th><td class="field-body">OK</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return str:</th><td class="field-body">JSON list of objecta containing the type names and
the about information from the file</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-service.job">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-service.job" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Cilantro</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, DAI WissIT.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/service.job.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>